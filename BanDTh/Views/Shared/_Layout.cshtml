@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor
@{
    var title = ViewData["Title"] as string ?? "TopZone Style";
    var role = HttpContextAccessor.HttpContext?.Session.GetString("UserRole") ?? "Guest";
    var email = HttpContextAccessor.HttpContext?.Session.GetString("UserEmail");
    var name = HttpContextAccessor.HttpContext?.Session.GetString("UserName");

}
<!doctype html>
<html lang="vi" data-bs-theme="dark">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@title</title>
    <meta name="description" content="Cửa hàng Apple phong cách TopZone (demo)" />

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
    <!-- Site CSS -->
    <link href="~/css/site.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<style>
.no-hover:hover {
    background-color: transparent !important;
    color: inherit !important;
}
    

    .navbar {
        background-color: #000 !important;
    }

    .navbar .nav-link {
        color: #fff !important;
        /* chữ trắng mặc định */
        padding: 1.2rem 1rem;
        /* canh khoảng cách đều nhau */
        border-radius: 0;
        /* bỏ bo góc */
        height: 100%;
        /* fit full chiều cao nav */
        display: flex;
        align-items: center;
        /* chữ nằm giữa theo chiều dọc */
        transition: background-color 0.3s;
        /* bỏ trong suốt */
        font-size: 15px;
        text-align: center;
    }

    .navbar .nav-link:hover {
        background-color: #767676 !important;

        /* hover -> xám nhẹ */
    }

    /* custom cho button tròn */
    .btn-circle {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background-color: #292929;
        /* nền đen */
        color: #fff;
        /* icon trắng */
        text-decoration: none;
        transition: all 0.3s ease;
    }

    .btn-circle:hover {
        background-color: #e0e0e0;
        /* xám trắng */
        color: #000;
        /* icon đen */
    }
    /* Nút tròn */
.btn-circle.dropdown-toggle::after {
  display: none !important; /* ẩn mũi tên của bootstrap */
}

/* Dropdown menu style */
.dropdown-menu {
  border-radius: 10px;
  max-width: 200px;
  background-color: #333; /* nền xám đậm */
  
}

.dropdown-item {
  padding: 10px 15px;
}

.dropdown-item:hover {
  background-color: #444; /* hover nền xám đậm */
  color: #fff;
}
html, body {
  overflow-x: hidden; /* chặn scroll ngang */
}

</style>
<script>
window.addEventListener("scroll", function () {
    const nav = document.getElementById("mainNav");
    const hero = document.getElementById("carouselExampleIndicators");

    if (!hero) return; // nếu không có carousel thì không làm gì

    const heroBottom = hero.offsetTop + hero.offsetHeight;
    const currentScroll = window.scrollY;

    if (currentScroll >= heroBottom) {
        // Khi cuộn qua khỏi vùng ảnh -> nav dính lên đầu
        nav.classList.add("fixed-top");
        nav.classList.add("bg-black"); // cho nền rõ hơn nếu cần
    } else {
        // Khi đang ở vùng ảnh -> nav ở vị trí ban đầu
        nav.classList.remove("fixed-top");
        nav.classList.remove("bg-black");
    }
});
</script>


<body class="bg-black text-body">
    <header class="sticky-top  p-0 ">
        <nav id="mainNav" class="navbar navbar-expand-lg navbar-dark bg-black p-0  ">
            <div class="container-fluid d-flex justify-content-between">
                <div class="d-flex mx-3">
                    <a class="navbar-brand fw-bold text-success" asp-controller="Home" asp-action="Index">
                        Top<small>Style</small>
                    </a>
                </div>
                <div class="d-none d-lg-flex mx-auto ">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link" asp-controller="Catalog" asp-action="Index" asp-route-category="i-phone">iPhone</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" asp-controller="Catalog" asp-action="Index" asp-route-category="dien-thoai">Điện Thoại</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" asp-controller="Catalog" asp-action="Index" asp-route-category="phu-kien">Phụ Kiện</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" asp-controller="Catalog" asp-action="Index" asp-route-category="tai-nghe">Tai Nghe</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" asp-controller="TinTuc" asp-action="Index">Tin Tức</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Chăm Sóc</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" asp-controller="KhuyenMai" asp-action="Index">Khuyến mãi</a>
                        </li>
                    </ul>

                </div>
                <!-- Bên phải (3 nút) -->
                <div class="d-flex justify-content-center gap-2">
                    <a class="btn-circle" asp-controller="Cart" asp-action="Index" aria-label="Giỏ hàng">
                        <i class="bi bi-search"></i>
                    </a>
                    <a class="btn-circle" asp-controller="Cart" asp-action="Index" aria-label="Giỏ hàng">
                        <i class="bi bi-bag"></i>
                    </a> 
                        <a class="btn-circle dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            <i class="bi bi-person"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end">
                            @if (role == "Admin")
    {
        <li><a class="dropdown-item" asp-controller="Admin" asp-action="Index">Dashboard</a></li>
        <li><a class="dropdown-item" asp-controller="Home" asp-action="Logout">Đăng xuất</a></li>
    }
    else if (role == "Customer")
    {
        <li><h6 class="dropdown-item no-hover" >Xin chào @name ! </li>
        <li><a class="dropdown-item" asp-controller="Home" asp-action="Login">Thông tin tài khoản</a></li>
        <li><a class="dropdown-item" href="/catalog?category=ipad">Thông Báo</a></li>
        <li><a class="dropdown-item" href="/catalog?category=mac">Lịch Sử Giao Dịch</a></li>
        <li><a class="dropdown-item" asp-controller="Home" asp-action="Logout">Đăng xuất</a></li>
    }
    else
    {
        <!-- Guest -->
        <li><a class="dropdown-item" asp-controller="Home" asp-action="Login">Đăng Nhập</a></li>
       
    }
                        </ul>
                </div>
            </div>
            </div>
        </nav>
    </header>

    <main class="container-fluid p-0 w-full pb-2">
        @RenderBody()
    </main>

    <footer class="border-top py-4 bg-black">
        <div class="container text-secondary small">
            <div>© @DateTime.Now.Year TopStyle demo. Không liên kết TopZone / Apple.</div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script> @* Đảm bảo bạn có jQuery *@
    @RenderSection("Scripts", required: false)
</body>

</html>